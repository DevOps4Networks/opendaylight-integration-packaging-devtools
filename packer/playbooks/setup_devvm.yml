---
- hosts: localhost
  sudo: yes

  vars:
    redhat_java_packages:
      - java-1.8.0-openjdk-devel
    debian_java_packages:
      - openjdk-8-jdk
    redhat_python3_packages:
      - python34
    debian_python3_packages:
      - python34
    redhat_desktop: xfce
#TODO: cinnamon is not working

  roles:
    - { role: redhat-smola.java }
    - { role: ansible-pip }
    - { role: ansible-linux-desktop }

  tasks:

  # Add odldev user in ODLDEV group and grant sudo permission
  - group: name=ODLDEV
  - user: name=odldev comment="ODL developer" uid=1010 group="ODLDEV" groups="wheel" shell=/bin/bash password=$6$rounds=656000$lL0xQ0LBywL04CXY$D4GxCJGv4P/dSpRkNJgUB/VB9XnXR94sOE9JTMuK189FrVhLbesixzhU0qfjuN3NihdH7YOs0RtsrhtEOGNey0

  - name: Initialise .xinirtc for RedHat Gnome Shell desktop
    shell: echo "exec gnome-session" >> ~odldev/.xinitrc
    when: redhat_desktop == 'gnome_shell'

  - name: Initialise .xinirtc for RedHat KDE desktop
    shell: echo "exec startkde" >> ~odldev/.xinitrc
    when: redhat_desktop == 'kde'

  - name: Initialise .xinirtc for RedHat Cinnamon desktop
    shell: echo "exec /usr/bin/cinnamon-session" >> ~odldev/.xinitrc
    when: redhat_desktop == 'cinnamon'

  - name: Initialise .xinirtc for RedHat MATE desktop
    shell: echo "exec /usr/bin/mate-session" >> ~odldev/.xinitrc
    when: redhat_desktop == 'mate'

  - name: Initialise .xinirtc for RedHat Xfce desktop
    shell: echo "exec /usr/bin/xfce4-session" >> ~odldev/.xinitrc
    when: redhat_desktop == 'xfce'

  - name: Set ownership for RedHat desktop .xinitrc
    file: path=~odldev/.xinitrc owner=odldev mode=0644 state=touch
    when: ansible_os_family == 'RedHat'

  - name: Install RedHat Python 3 packages
    yum: name={{ item }} state=latest
    with_items: redhat_python3_packages
    when: ansible_os_family == 'RedHat'

  - name: Install Debian Python 3 packages
    apt: name={{ item }} state=latest
    with_items: debian_python3_packages
    when: ansible_os_family == 'Debian'

